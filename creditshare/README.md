# 机制使用同态加密算法：Paillier算法
Paillier算法理论基础：http://www.tcnj.edu/~hagedorn/papers/CapstonePapers/OKeeffe/CapstoneOKeeffeCryptography.pdf

# 信用分的同态隐私保护的设计

已有征信机构A，B，C，D构建征信区块链联盟链，征信用户Alice拥有自己的私钥，而其公钥是公开已知的。Alice在A，B，C有过征信记录，机构A，B，C对Alice的信誉评分分别为Ra, Rb，Rc。如今，Alice想向机构D借钱，机构D希望得到Alice的平均征信评分，而且在保证在A, B, C不相互泄露用户征信评分的前提下。

## 阶段1：构建征信联盟
1. 征信机构A，B，C，D共同维护一条区块链联盟链。
2. 征信机构会用用户公钥对用户信誉评分进行加密，并将密文写入联盟链中，注意此时机构A不能通过链上数据获得机构B对某个用户评分的明文，因为私钥掌握在用户手中。
3. 利用Go, Solidity等智能合约语言编写智能合约，其主要逻辑如下（对应技术内容b）中的4），对输入的某个用户的评分密文进行计算处理：$Sum_t=Sum_{t-1}*R mod n^2$，得到评分求和结果的密文。

## 阶段2：Alice向机构D提出借贷申请，机构需要审核Alice在联盟中的平均信誉评分
1.  Alice向机构D提出借贷申请
2. 机构D向智能合约提出查询Alice的平均信誉评分。
3. 智能合约响应机构D的请求，并把各机构评分结果求和的密文发送给机构D,此时机构D并不知道评分总和的明文。
4. 机构D把求和密文转发给用户Alice，希望Alice揭示自己的信誉总和。

## 阶段3：Alice向机构D揭示自己的信誉均值 
1. Alice用自己的私钥对接收到的信誉总和密文进行解密，得到总和明文m，并把m发送给机构D
2. 机构D用Alice的公钥对明文m进行加密与其得到的求和密文进行比对，若一致则接受明文m
3. 机构D通过查询链上数据得到对Alice进行评分的机构数量为k
4. 机构D得到Alice的平均信誉评分为m/k，并决定是否给Alice进行贷款
